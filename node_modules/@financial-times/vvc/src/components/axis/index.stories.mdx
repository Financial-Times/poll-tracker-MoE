import { Meta, Story, Preview } from '@storybook/addon-docs/blocks';
import { css } from '@emotion/core';
import { letterFrequency } from '@visx/mock-data';
import { scaleLinear, scaleBand, scaleUtc } from '@visx/scale';
import ChartFrame from '../chart-frame';
import Debug from '../../util/debug';
import Axis from './';

<Meta title="Components/Axes" component={Axis} />

# Axis components

These are used to generate axes, there a few kinds

##### Tick values and additional tick values

By default, given a scale the axis will generate tick values for you. If you want to override these completely, you can use the
`tickValues` prop. You can pass an array of strings, numbers or objects (if you're using the `tickPositionVariable`).

If you want to add additional values to the generated tick values, use `additionalTickValues` (this has the same type as `tickValues`).
The axis component will then add these ticks to the generated array, filter out duplicates and sort by their scaled Y position.

##### Props

`invertAxis` boolean. False by default

##### Axis arrows

To use axis arrows, add an `axisArrows` prop with an array of objects with the following keys (each object represents one arrow):

- direction: pointing `right` or `left`
- startValue: value on the x-axis to start the arrow
- length: number in pixels
- value: label above or below the arrow

You can also set a padding (object with `top`, `right`, `bottom`, and `left`) around the axisArrows using the prop `axisArrowsPadding`. There is a default set that should work for most charts, so it isn't required.

### Web (default) axes

<Preview>
  <Story name="Web">
    <ChartFrame title="Axes" subtitle="All of them">
      <Debug showMargin={true} showPadding={true} />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 10000000000],
        })}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Social axes

<Preview>
  <Story name="Social">
    <ChartFrame type="social" title="Axes (social)" subtitle="All of them">
      <Debug />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 10000000000],
        })}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Print axes

<Preview>
  <Story name="Print">
    <ChartFrame type="print" title="Axes (print)" subtitle="All of them">
      <Debug />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 10000000000],
        })}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Video axes

<Preview>
  <Story name="Video">
    <ChartFrame type="video" title="Axes (video)" subtitle="All of them">
      <Debug />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 10000000000],
        })}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web bottom axis w/ label

<Preview>
  <Story name="Web bottom axis w/ label">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Something explaining the x-axis'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web bottom axis w/ label (two lines)

<Preview>
  <Story name="Web bottom axis w/ label (two lines)">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Something explaining the x-axis | even more about the x-axis'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web top axis w/ label

<Preview>
  <Story name="Web top axis w/ label">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Something explaining the x-axis'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web top axis w/ label (two lines)

<Preview>
  <Story name="Web top axis w/ label (two lines)">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Something explaining the x-axis | even more about the x-axis'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web left axis w/ label

<Preview>
  <Story name="Web left axis w/ label">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Y-axis label'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web left axis w/ label (two lines)

<Preview>
  <Story name="Web left axis w/ label (two lines)">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Y-axis label|Left'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web right axis w/ label

<Preview>
  <Story name="Web right axis w/ label">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Y-axis label'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web right axis w/ label (two lines)

<Preview>
  <Story name="Web right axis w/ label (two lines)">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Debug showMargin showPadding />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        label={'Y-axis label|Right'}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web bottom axis without end ticks

<Preview>
  <Story name="Web bottom axis without end ticks">
    <ChartFrame title="Axes" subtitle="All of them" height={300}>
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, Math.max(...letterFrequency.map((d) => d['frequency'])) * 100000],
        })}
        hideEndTicks
      />
    </ChartFrame>
  </Story>
</Preview>

### Web top axis with axis arrows

<Preview>
  <Story name="Web top axis with axis arrows">
    <ChartFrame
      title="Axes"
      subtitle="All of them"
      height={300}
      margin={{ top: 130, right: 5, bottom: 105, left: 20 }}
    >
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [-10, 10],
        })}
        axisArrows={[
          {
            direction: 'left',
            startValue: 0,
            length: 36,
            value: 'Biden leads',
          },
          {
            direction: 'right',
            startValue: 0,
            length: 36,
            value: 'Trump leads',
          },
        ]}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [-10, 10],
        })}
        axisArrowsPadding={{ left: 30, right: 30 }}
        axisArrows={[
          {
            direction: 'left',
            startValue: 0,
            length: 36,
            value: 'Biden leads',
          },
          {
            direction: 'right',
            startValue: 0,
            length: 36,
            value: 'Trump leads',
          },
        ]}
      />
    </ChartFrame>
  </Story>
</Preview>

### Web bottom w/ custom tick positions

##### Custom tick positions

Using the `tickValues`, `tickPositionVariable` and `tickLabelVariable (default: label)` props
it's possible to set create an axis with custom tick positions. Pass an array of objects to `tickValues`
with attributes for the position (which must be within the domain of the scale passed to the axis) and label.
e.g. `[{ label: "A", xPosition: 0 }, { label: "B", xPosition: 10 }, { label: "C", xPosition: 50 }]`.
Set `tickPositionVariable` to the variable that will be passed to the scale (e.g. `xPosition`) and `tickLabelVariable`
to the attribute that will be used to set the label (e.g. `label`). The range of the scale passed to the axis must already
be defined for this to work - either set it manually or make sure it is set elsewhere in the template by another component.

<Preview>
  <Story name="Web bottom w/ custom tick positions">
    <ChartFrame title="Axes" subtitle="Bottom" height={300} width={500}>
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, 100],
          range: [0, 300],
        })}
        tickValues={[
          { label: 'A', xPosition: 0 },
          { label: 'B', xPosition: 10 },
          { label: 'C', xPosition: 50 },
          { label: 'D', xPosition: 65 },
          { label: 'E', xPosition: 100 },
        ]}
        tickPositionVariable="xPosition"
        tickLabelVariable="label"
      />
    </ChartFrame>
  </Story>
</Preview>

### Invert Axis

Uses the prop `invertAxis` to reverse the defined or sorted axis order. It does this by reversing the `scale.domain` or `tickScale.domain` as it is passed to the axis group for rendering. Instead of passing the scale directly, it is passed to a function that copies the scale and conditionally inverts it depending on the `invertAxis` prop.

The copied scale is returned from the function, this circumvents issues of the axis being re-inverted when axis is rendered more than once to calculate the frame size

<Preview>
  <Story name="Inverted ordinal">
    <ChartFrame title="Inverted axis" subtitle="Ordinal, bottom axis inverted" height={300}>
      <Axis
        orientation={'top'}
        scale={scaleBand({
          domain: ['Afghan Hound', 'Siluki', 'Greyhound', 'Whippet'],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleBand({
          domain: ['Afghan Hound', 'Siluki', 'Greyhound', 'Whippet'],
        })}
        invertScale={true}
      />
    </ChartFrame>
  </Story>
</Preview>

<Preview>
  <Story name="Inverted linear">
    <ChartFrame title="Inverted axis" subtitle="Linear, bottom axis inverted" height={300}>
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, 450],
        })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, 450],
        })}
        invertScale={true}
      />
    </ChartFrame>
  </Story>
</Preview>

<Preview>
  <Story name="Inverted custom">
    <ChartFrame
      title="Inverted axis"
      subtitle="Custom labels, bottom axis inverted"
      height={300}
      width={500}
    >
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, 100],
          range: [0, 400],
        })}
        tickValues={[
          { label: 'A', xPosition: 0 },
          { label: 'B', xPosition: 10 },
          { label: 'C', xPosition: 50 },
          { label: 'D', xPosition: 65 },
          { label: 'E', xPosition: 100 },
        ]}
        tickPositionVariable="xPosition"
        tickLabelVariable="label"
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, 100],
          range: [0, 400],
        })}
        tickValues={[
          { label: 'A', xPosition: 0 },
          { label: 'B', xPosition: 10 },
          { label: 'C', xPosition: 50 },
          { label: 'D', xPosition: 65 },
          { label: 'E', xPosition: 100 },
        ]}
        tickPositionVariable="xPosition"
        tickLabelVariable="label"
        invertScale={true}
      />
    </ChartFrame>
  </Story>
</Preview>

<Preview>
  <Story name="Inverted ordinal left/right">
    <ChartFrame title="Inverted axis" subtitle="Ordinal, right axis inverted" height={400}>
      <Axis
        orientation={'left'}
        scale={scaleBand({
          domain: ['Afghan Hound', 'Siluki', 'Greyhound', 'Whippet'],
        })}
        hideTicks={true}
      />
      <Axis
        orientation={'right'}
        scale={scaleBand({
          domain: ['Afghan Hound', 'Siluki', 'Greyhound', 'Whippet'],
        })}
        hideTicks={true}
        invertScale={true}
      />
    </ChartFrame>
  </Story>
</Preview>

<Preview>
  <Story name="Inverted linear left/right">
    <ChartFrame title="Inverted axis" subtitle="Linear, right axis inverted" height={500}>
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, 450],
        })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, 450],
        })}
        invertScale={true}
      />
    </ChartFrame>
  </Story>
</Preview>

### Axis with additional ticks

<Preview>
  <Story name="Axis with additional ticks">
    <ChartFrame title="Axis with additional ticks">
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        additionalTickValues={[50]}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        additionalTickValues={[950]}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        additionalTickValues={[450]}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        additionalTickValues={[750]}
      />
    </ChartFrame>
  </Story>
</Preview>

### Axis with per tick label props

<Preview>
  <Story name="Axis with per tick label props">
    <ChartFrame title="Axis with per tick label props">
      <Axis
        orientation={'left'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        tickLabelProps={(tickLabel, i) => ({ style: { fontSize: i * 2 } })}
      />
      <Axis
        orientation={'right'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        tickLabelProps={(tickLabel, i) => ({ style: { fontSize: i * 2 } })}
      />
      <Axis
        orientation={'top'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        tickLabelProps={(tickLabel, i) => ({ style: { fontSize: i * 2 } })}
      />
      <Axis
        orientation={'bottom'}
        scale={scaleLinear({
          domain: [0, 1000],
        })}
        tickLabelProps={(tickLabel, i) => ({ style: { fontSize: i * 2 } })}
      />
    </ChartFrame>
  </Story>
</Preview>
