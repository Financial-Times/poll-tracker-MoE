import { Meta, Story, Preview } from '@storybook/addon-docs/blocks';
import { useState } from 'react';
import { scaleLinear, scaleTime } from '@visx/scale';
import { withKnobs, boolean } from '@storybook/addon-knobs';
import { extent } from 'd3-array';
import { Dots } from './';
import ChartFrame from '../chart-frame';

export const limitXScaleKnob = (limitXScale) => boolean('Limit X scale', limitXScale);
export const limitYScaleKnob = (limitYScale) => boolean('Limit Y scale', limitYScale);

<Meta title="Components/Dots" component={Dots} />

# Dots

Dots are collections of points

export const sineDataOverTime = Array(10)
  .fill()
  .map((d, i) => ({
    x: i,
    y: Math.sin(i),
    color: 'blue',
    label: `item: ${i}`,
    id: i,
  }));

### Basic use (sine generator data)

<Preview>
  <Story name="Basic use">
    <ChartFrame>
      <Dots
        data={sineDataOverTime}
        xScale={scaleTime({ domain: extent(sineDataOverTime, (d) => d.x) })}
        yScale={scaleLinear({
          domain: extent(sineDataOverTime, (d) => d.y),
        })}
        xVariable="x"
        yVariable="y"
        colorVariable="color"
        labelVariable="label"
        labelProps={(cx, cy, r, color) => ({
          labelAnchor: 'start',
          points: [{ x: cx, y: cy }],
          labelFill: color,
          // @TODO change to scaled font value
          labelFontSize: 18,
          labelDx: 2 * r,
          labelDy: r,
        })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Basic use with tooltips

<Preview>
  <Story name="With tooltip">
    <ChartFrame>
      <Dots
        data={sineDataOverTime}
        xScale={scaleTime({ domain: extent(sineDataOverTime, (d) => d.x) })}
        yScale={scaleLinear({
          domain: extent(sineDataOverTime, (d) => d.y),
        })}
        xVariable="x"
        yVariable="y"
        colorVariable="color"
        labelVariable="label"
        labelProps={(cx, cy, r, color) => ({
          labelAnchor: 'start',
          points: [{ x: cx, y: cy }],
          labelFill: color,
          // @TODO change to scaled font value
          labelFontSize: 18,
          labelDx: 2 * r,
          labelDy: r,
        })}
        showTooltips={true}
      />
    </ChartFrame>
  </Story>
</Preview>

### Changing x/y scale

<Preview>
  <Story name="Changing x/y scale">
    <ChartFrame>
      <Dots
        data={sineDataOverTime}
        xScale={scaleTime({
          domain: [
            extent(sineDataOverTime, (d) => d.x)[0],
            extent(sineDataOverTime, (d) => d.x)[1] * (limitXScaleKnob(false) ? 0.5 : 1),
          ],
        })}
        yScale={scaleLinear({
          domain: [
            extent(sineDataOverTime, (d) => d.y)[0],
            extent(sineDataOverTime, (d) => d.y)[1] * (limitYScaleKnob(false) ? 0.5 : 1),
          ],
        })}
        xVariable="x"
        yVariable="y"
        colorVariable="color"
        labelVariable="label"
        labelProps={(cx, cy, r, color) => ({
          labelAnchor: 'start',
          points: [{ x: cx, y: cy }],
          labelFill: color,
          // @TODO change to scaled font value
          labelFontSize: 18,
          labelDx: 2 * r,
          labelDy: r,
        })}
      />
    </ChartFrame>
  </Story>
</Preview>
