import { Meta, Story, Preview } from '@storybook/addon-docs/blocks';
import { useState } from 'react';
import { scaleLinear, scaleTime, scaleOrdinal } from '@visx/scale';
import { withKnobs, boolean } from '@storybook/addon-knobs';
import { extent } from 'd3-array';
import { Line, Lines } from './';
import ChartFrame from '../chart-frame';

export const limitXScaleKnob = (limitXScale) => boolean('Limit X scale', limitXScale);
export const limitYScaleKnob = (limitYScale) => boolean('Limit Y scale', limitYScale);

<Meta title="Components/Lines" component={[Line, Lines]} decorators={[withKnobs]} />

# Lines

Lines are long, often-squiggly things that usually depict a trend.

export const sineDataOverTime = Array(10)
  .fill()
  .map((d, i) => ({
    x: i,
    y: Math.sin(i),
    anotherY: Math.sin(i) * 0.5,
    color: 'blue',
    label: `item: ${i}`,
    id: i,
  }));

### Basic use, single line (sine generator data)

<Preview>
  <Story name="Basic use (line)">
    <ChartFrame>
      <Line
        data={sineDataOverTime}
        xScale={scaleTime({ domain: extent(sineDataOverTime, (d) => d.x) })}
        yScale={scaleLinear({
          domain: extent(sineDataOverTime, (d) => d.y),
        })}
        xVariable="x"
        yVariable="y"
        color="blue"
      />
    </ChartFrame>
  </Story>
</Preview>

### Basic use, multline (sine generator data)

<Preview>
  <Story name="Basic use (lines)">
    <ChartFrame>
      <Lines
        data={sineDataOverTime}
        xScale={scaleTime({ domain: extent(sineDataOverTime, (d) => d.x) })}
        yScale={scaleLinear({
          domain: extent(sineDataOverTime, (d) => d.y),
        })}
        xVariable="x"
        seriesNames={['y', 'anotherY']}
        colorScale={scaleOrdinal({ domain: ['y', 'anotherY'], range: ['blue', 'red'] })}
      />
    </ChartFrame>
  </Story>
</Preview>

### Changing x/y scale

<Preview>
  <Story name="Changing x/y scale">
    <ChartFrame>
      <Lines
        data={sineDataOverTime}
        xScale={scaleTime({
          domain: [
            extent(sineDataOverTime, (d) => d.x)[0],
            extent(sineDataOverTime, (d) => d.x)[1] * (limitXScaleKnob(false) ? 0.5 : 1),
          ],
        })}
        yScale={scaleLinear({
          domain: [
            extent(sineDataOverTime, (d) => d.y)[0],
            extent(sineDataOverTime, (d) => d.y)[1] * (limitYScaleKnob(false) ? 0.5 : 1),
          ],
        })}
        xVariable="x"
        seriesNames={['y', 'anotherY']}
        colorScale={scaleOrdinal({ domain: ['y', 'anotherY'], range: ['blue', 'red'] })}
      />
    </ChartFrame>
  </Story>
</Preview>
