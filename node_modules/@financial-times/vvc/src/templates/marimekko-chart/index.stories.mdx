import { Meta, Story, Preview } from '@storybook/addon-docs/blocks';
import MarimekkoChart from './';
import categoricalUsSampleData from '../../sample-data/categorical-us';

<Meta title="Templates/Marimekko chart" component={MarimekkoChart} />

# Marimekko chart

A marimekko chart template.

The following props are necessary to create a Marimekko chart:

- `xVariable`: The horizontal width of each bar
- `yLabelVariable`: The category for each bar
- `yVariable`: The vertical height of each bar

Other optional props:

- `barPaddingInner`: The amount of space between each bar in relation to the values in the chart (scale of each unit is equal the yVariable units)
- `barPaddingOuter`: The amount of space on the outer side of the first and last bars in relation to the values in the chart

Setting the prop `marimekkoKey` to `true` will render an instance of the `<MarimekkoKey>` component, which is configurable via the following props (all of which have pre-set defaults and can be set on the chart template):

- `barHeightAnnotation`: The text for the bar height annotation, e.g. “Bar height shows xyz”
- `barHeightAnnotationLineHeight`: The vertical height of the bar height annotation line
- `barHeightAnnotationWidth`: The width of the bar height annotation text. Use this to obtain the desired text wrapping
- `keyBarsWidth`: The width of the Marimekko bars in the key
- `keyData`: An array of objects with `width` and `height` properties used to render the Marimekko bars in the key
- `keyHeight`: The total height of the key element
- `keyTitle`: The key title
- `keyTitleWidth`: The width of the key title text. Use this to obtain the desired text wrapping
- `keyMarginBottom`: The vertical space between the bottom of the key and the chart area (for the most part, this is the height of the top axis plus any space you want between it and the key)

`barHeightAnnotation` and `barHeightAnnotationWidth` should be the only ones that need to be specified in most cases.

### Web — default props

<Preview>
  <Story name="Web - default props">
    <MarimekkoChart height={600} margin={{ top: 130, right: 5, bottom: 105, left: 20 }} />
  </Story>
</Preview>

### Web (with props)

<Preview>
  <Story name="Web - with props">
    <MarimekkoChart
      barPaddingInner={1}
      data={categoricalUsSampleData}
      height={600}
      margin={{ top: 130, right: 5, bottom: 105, left: 20 }}
      xAxisOrientation="top"
      xVariable="margin"
      yLabelVariable="state"
      yVariable="ecvotes"
    />
  </Story>
</Preview>

## Web (with props and key)

<Preview>
  <Story name="Web - with props and key">
    <MarimekkoChart
      title={
        "How <tspan style='fill: #1056b6; font-weight: 600;'>Biden</tspan> and <tspan style='fill: #ed4748; font-weight: 600;'>Trump</tspan> are polling in the closest states"
      }
      titleMarkupCustom
      subtitle="Average poll margin in percentage points"
      source="Includes states with more than one recent poll"
      copyright={false}
      barHeightAnnotation={'Bar height shows number of electoral college votes'}
      barHeightAnnotationWidth={126}
      barPaddingOuter={2}
      barPaddingInner={1}
      data={categoricalUsSampleData}
      height={600}
      marimekkoKey={true}
      margin={{ top: 80, right: 5, bottom: 105, left: 20 }}
      xAxisOrientation="top"
      yAxisOrientation="left"
      xTickFormat={(tick) => `${Math.abs(tick)}`}
      xHideAxisLine
      yHideAxisLine
      yHideTicks
      xFullLengthTicks
      xAxisArrows={[
        {
          direction: 'left',
          startValue: 0,
          length: 36,
          value: 'Biden leads',
        },
        {
          direction: 'right',
          startValue: 0,
          length: 36,
          value: 'Trump leads',
        },
      ]}
      xVariable="margin"
      yLabelVariable="state"
      yVariable="ecvotes"
      fill="red"
      colorScale={(value) => (value > 0 ? '#ffaca3' : '#67b4e2')}
      colorVariable="margin"
      xAxisTickLabelProps={() => ({
        dy: '-8px',
      })}
      xMax={5}
      xMin={-5}
      xTicks={[-4, -2, 0, 2, 4]}
      keyMarginBottom={86}
    />
  </Story>
</Preview>
