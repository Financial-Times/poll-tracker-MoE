import { select } from "d3-selection";


function isSvg(node) {
	return node.tagName.toLowerCase() === "svg";
}


function getContainers(target) {
	var container;
	if (target && target.select && target.selectAll) {
		container = select(target.node()); // Make sure we have a select not selectAll
	}
	else container = select(target);
	var container_node = container.node();
	if (!container_node) throw new Error("Chart layout instance must have a target");
	var container_is_svg = isSvg(container_node);

	var getSvg = function() {
		if (container_is_svg) return container;
		var current_node = container_node.parentElement;
		while (current_node && !isSvg(current_node)) current_node = current_node.parentElement;
		if (!isSvg(current_node)) throw new Error("target must be an SVG or a descendant of an SVG");
		return select(current_node);
	};

	return { container: container, getSvg: getSvg };
}


export { getContainers };
