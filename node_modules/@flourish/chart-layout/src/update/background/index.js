function initBackgroundUpdating(instance, state) {
	var bg = state.background;
	var fill = instance.chart.select("rect.fl-chart-fill");
	var image = instance.chart.select("image.fl-chart-image");
	var rect = instance.chart.select("rect.fl-chart-interaction");

	return function() {
		var x_range = instance.xScale().range();
		var y_range = instance.yScale().range();

		var x = x_range[0];
		var y = y_range[1];
		var width = Math.max(instance.plot_width, 1);
		var height = Math.max(instance.plot_height, 1);

		fill
			.attr("x", x)
			.attr("y", y)
			.attr("width", width)
			.attr("height", height)
			.attr("fill", bg.background_color_enabled ? bg.background_color : "none");
		image
			.attr("x", x)
			.attr("y", y)
			.attr("width", width)
			.attr("height", height)
			.attr("xlink:href", bg.background_image_enabled ? bg.background_image_src : null)
			.attr("preserveAspectRatio", function() {
				if (bg.background_image_size == "stretch") return "none";
				return bg.background_image_position + " " + bg.background_image_size;
			});
		rect
			.attr("x", x)
			.attr("y", y)
			.attr("width", width)
			.attr("height", height);
	};
}


export { initBackgroundUpdating };
