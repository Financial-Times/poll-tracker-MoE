import { isUrl } from "@flourish/pocket-knife";
import { state } from "../core/init";

var header_el, title_el, subtitle_el, text_el, logo_el;

function init() {
	header_el = document.createElement("header");
	header_el.className = "flourish-header";

	var hgroup_el = document.createElement("hgroup");
	title_el = document.createElement("h1");
	subtitle_el = document.createElement("h2");
	text_el = document.createElement("p");
	logo_el = document.createElement("img");

	header_el.appendChild(logo_el);
	header_el.appendChild(hgroup_el);
	hgroup_el.appendChild(title_el);
	hgroup_el.appendChild(subtitle_el);
	header_el.appendChild(text_el);

	return header_el;
}


function update() {
	header_el.style.textAlign = state.header_align;
	header_el.style.margin = 0;
	header_el.style.borderTop = state.header_border == "top" ? state.header_border_width + "px " + state.header_border_style + " " + state.header_border_color : null;
	header_el.style.borderBottom = state.header_border == "bottom" ? state.header_border_width + "px " + state.header_border_style + " " + state.header_border_color : null;
	header_el.style.paddingTop = state.header_border == "top" ? state.header_border_space + "rem" : "";
	header_el.style.paddingBottom = state.header_border == "bottom" ? state.header_border_space + "rem" : "";

	title_el.innerHTML = state.title ? state.title : "";
	title_el.style.fontFamily = state.title_font ? state.title_font.name : "inherit"; // Check for inherit, then font name
	title_el.style.fontSize = (state.title_size != "custom" ? state.title_size : state.title_size_custom) + "rem";
	title_el.style.lineHeight = state.title_line_height;
	title_el.style.fontWeight = state.title_weight;
	title_el.style.color = state.title_color || state.font_color;
	title_el.style.margin = 0;
	title_el.style.paddingTop = !state.title ? 0 : (state.title_space_above == "custom" ? state.title_space_above_custom : state.title_space_above) + "rem";

	subtitle_el.innerHTML = state.subtitle ? state.subtitle : "";
	subtitle_el.style.fontFamily = state.subtitle_font ? state.subtitle_font.name : "inherit"; // Check for inherit, then font name
	subtitle_el.style.fontSize = (state.subtitle_size != "custom" ? state.subtitle_size : state.subtitle_size_custom) + "rem";
	subtitle_el.style.lineHeight = state.subtitle_line_height;
	subtitle_el.style.fontWeight = state.subtitle_weight;
	subtitle_el.style.color = state.subtitle_color || state.font_color;
	subtitle_el.style.margin = 0;
	subtitle_el.style.paddingTop = !state.subtitle ? 0 : (state.subtitle_space_above == "custom" ? state.subtitle_space_above_custom : state.subtitle_space_above) + "rem";

	text_el.innerHTML = state.header_text ? state.header_text : "";
	text_el.style.fontSize = (state.header_text_size != "custom" ? state.header_text_size : state.header_text_size_custom) + "rem";
	text_el.style.lineHeight = state.header_text_line_height;
	text_el.style.fontWeight = state.header_text_weight;
	text_el.style.margin = 0;
	text_el.style.color = state.header_text_color || state.font_color;
	text_el.style.paddingTop = !state.header_text ? 0 : (state.header_text_space_above == "custom" ? state.header_text_space_above_custom : state.header_text_space_above) + "rem";

	logo_el.style.display = state.header_logo_enabled && isUrl(state.header_logo_src) ? "" : "none";
	logo_el.style.position = state.header_logo_align == "inside" ? "" : "fixed";
	logo_el.style.height = state.header_logo_height + "rem";
	logo_el.style.top = state.header_logo_align == "outside" ? 0 : "";
	logo_el.style.left = state.header_logo_align == "outside" && state.header_logo_position_outside == "left" ? 0 : "";
	logo_el.style.right = state.header_logo_align == "outside" && state.header_logo_position_outside == "right" ? 0 : "";
	logo_el.style.marginTop = state.header_logo_margin_top + "rem";
	logo_el.style.marginBottom = state.header_logo_margin_bottom + "rem";
	logo_el.style.marginLeft = state.header_logo_margin_left + "rem";
	logo_el.style.marginRight = state.header_logo_margin_right + "rem";
	logo_el.style.float = state.header_logo_position_inside == "top" || state.header_logo_align == "outside" ? "" : state.header_logo_position_inside;
	logo_el.style.width = "auto";
	logo_el.src = isUrl(state.header_logo_src) ? state.header_logo_src : "";
}


export { init, update };
